# RTA CCTV System - Environment Configuration Template
# Copy this file to .env and fill in your values

# ============================================
# STORAGE CONFIGURATION
# ============================================
STORAGE_MODE=BOTH                    # Options: LOCAL, MILESTONE, BOTH
STORAGE_BACKEND=MINIO                # Options: MINIO, S3, FILESYSTEM
RETENTION_DAYS=90

# ============================================
# MILESTONE VMS
# ============================================
MILESTONE_SERVER=milestone.rta.ae:554
MILESTONE_USER=vms_service_account
MILESTONE_PASS=change_me_milestone_password
MILESTONE_AUTH_TYPE=WindowsDefault

# ============================================
# MINIO / S3 STORAGE
# ============================================
MINIO_ENDPOINT=minio:9000
MINIO_ROOT_USER=admin
MINIO_ROOT_PASSWORD=change_me_minio_password
MINIO_USE_SSL=false

# MinIO Buckets
MINIO_BUCKET_RECORDINGS=cctv-recordings
MINIO_BUCKET_EXPORTS=cctv-exports
MINIO_BUCKET_THUMBNAILS=cctv-thumbnails
MINIO_BUCKET_CLIPS=cctv-clips

# Service Credentials for MinIO
RECORDING_SERVICE_PASSWORD=change_me_recording_password
STORAGE_SERVICE_PASSWORD=change_me_storage_password
PLAYBACK_SERVICE_PASSWORD=change_me_playback_password

# ============================================
# DATABASES
# ============================================
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=cctv
POSTGRES_USER=cctv
POSTGRES_PASSWORD=change_me_postgres_password
POSTGRES_MAX_CONNECTIONS=100

# ============================================
# VALKEY (Redis-compatible)
# ============================================
VALKEY_ADDR=valkey:6379
VALKEY_PASSWORD=change_me_valkey_password
VALKEY_MAX_MEMORY=1gb
VALKEY_DB=0

# ============================================
# AGENCY STREAM LIMITS
# ============================================
LIMIT_DUBAI_POLICE=50
LIMIT_METRO=30
LIMIT_BUS=20
LIMIT_OTHER=400
LIMIT_TOTAL=500

# ============================================
# LIVEKIT CONFIGURATION
# ============================================
LIVEKIT_URL=http://livekit:7880
LIVEKIT_API_KEY=change_me_livekit_api_key
LIVEKIT_API_SECRET=change_me_livekit_api_secret
LIVEKIT_WEBHOOK_KEY=change_me_livekit_webhook_key

# ============================================
# TURN SERVER (coturn)
# ============================================
TURN_DOMAIN=turn.rta.ae
TURN_USER=rta
TURN_PASSWORD=change_me_turn_password
TURN_PORT=3478
TURN_TLS_PORT=5349

# ============================================
# JWT & AUTHENTICATION
# ============================================
JWT_SECRET=change_me_jwt_secret_key_min_32_chars
JWT_ISSUER=rta-iam
JWT_EXPIRY_HOURS=1
RTA_IAM_PUBLIC_KEY_PATH=/secrets/rta_iam_public_key.pem

# ============================================
# API GATEWAY (Kong)
# ============================================
KONG_ADMIN_API=http://kong:8001
KONG_PROXY_URL=http://kong:8000

# ============================================
# MONITORING
# ============================================
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=change_me_grafana_password
PROMETHEUS_RETENTION_DAYS=30

# ============================================
# LOGGING
# ============================================
LOG_LEVEL=info                       # Options: debug, info, warn, error
LOG_FORMAT=json                      # Options: json, text

# ============================================
# RECORDING CONFIGURATION
# ============================================
RECORDING_SEGMENT_DURATION=300       # Seconds (5 minutes)
RECORDING_MAX_WORKERS=50
RECORDING_BUFFER_SIZE_MB=50
FFMPEG_PRESET=copy                   # H.264 copy (no transcoding)

# ============================================
# OBJECT DETECTION (AI)
# ============================================
AI_MODEL_PATH=/models/yolov8n.onnx
AI_CONFIDENCE_THRESHOLD=0.5
AI_SAMPLE_RATE=1                     # Frames per second to analyze
AI_BATCH_SIZE=10
AI_ENABLE_GPU=false                  # Set to true if GPU available
AI_CLASSES=person,vehicle,license_plate

# ============================================
# PLAYBACK CONFIGURATION
# ============================================
PLAYBACK_CACHE_SIZE_GB=50
PLAYBACK_CACHE_PATH=/cache/playback
PLAYBACK_SIGNED_URL_EXPIRY=300       # Seconds (5 minutes)
PLAYBACK_HLS_SEGMENT_DURATION=2      # Seconds

# ============================================
# NETWORK CONFIGURATION
# ============================================
PUBLIC_IP=0.0.0.0                    # Replace with actual public IP
RTSP_TRANSPORT=tcp
RTSP_TIMEOUT=10s
WEBRTC_PORT_RANGE_START=50000
WEBRTC_PORT_RANGE_END=50500

# ============================================
# PERFORMANCE TUNING
# ============================================
MEDIAMTX_MAX_CONNECTIONS=600
MEDIAMTX_READ_BUFFER_COUNT=64
GO_MAX_PROCS=0                       # 0 = use all available cores
GOMAXPROCS=0

# ============================================
# DEVELOPMENT / DEBUG
# ============================================
DEBUG_MODE=false
ENABLE_PPROF=false                   # Go profiling
ENABLE_SWAGGER=true                  # API documentation UI
CORS_ALLOWED_ORIGINS=https://*.rta.ae

# ============================================
# BACKUP CONFIGURATION
# ============================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *            # Cron: Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_PATH=/backup

# ============================================
# ALERT CONFIGURATION
# ============================================
ALERT_EMAIL=ops@rta.ae
ALERT_WEBHOOK=https://alerts.rta.ae/webhook
ALERT_THRESHOLD_STORAGE_PCT=85
ALERT_THRESHOLD_LATENCY_MS=1000

# ============================================
# FEATURE FLAGS
# ============================================
FEATURE_OBJECT_DETECTION=true
FEATURE_CLIP_MANAGEMENT=true
FEATURE_PTZ_CONTROL=true
FEATURE_EXPORT_VIDEO=true
